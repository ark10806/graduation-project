{"ast":null,"code":"import _slicedToArray from\"/home/seungchan/Desktop/Projs/kakao/Kakao_ML/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _toConsumableArray from\"/home/seungchan/Desktop/Projs/kakao/Kakao_ML/frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import React,{useState,useRef}from'react';import axios from'axios';import{proxyAddr}from'./ProxyAddr';// import { proxyAddr } from './ProxyAddr'\nimport{CButton,CButtonGroup,CCard,CCardBody,CCardFooter,CProgress,CCol,CRow,CImage,CSpinner,CFormInput,CInputGroup}from'@coreui/react';axios.defaults.withCredentials=true;import CIcon from'@coreui/icons-react';import{cibTwitter,cilCloudDownload,cilUser,cilMagnifyingGlass}from'@coreui/icons';import{Line,getElementAtEvent}from\"react-chartjs-2\";import{Chart,registerables}from'chart.js';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";Chart.register.apply(Chart,_toConsumableArray(registerables));var btnColors=[false,false,false,false,false,false,false,false,false,false,false];//! daily, weekly, montly, year로 다양화 필요\nvar categoryPanel=[{title:'politics'},{title:'social'},{title:'economy'},{title:'fashion'},{title:'entertain'},{title:'sports'},{title:'foods'},{title:'animals'},{title:'selfies'},{title:'memes'},{title:'cartoons'},{title:'movies'},{title:'games'},{title:'landscapes'}];var arr_posts;var search_keyword=\"\";export var DrawChart=function DrawChart(){var _useState=useState({disabledInput:false,disabledBtn:false,text:'submit'}),_useState2=_slicedToArray(_useState,2),keywdBtn=_useState2[0],setKeywdBtn=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),posts=_useState4[0],setPosts=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),flows=_useState6[0],getFlow=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),x=_useState8[0],getX=_useState8[1];var _useState9=useState(btnColors),_useState10=_slicedToArray(_useState9,2),btnColor=_useState10[0],setColor=_useState10[1];var url=proxyAddr();var start_date=new Date('2021-01-01');var end_date=new Date('2022-02-01');var chartRef=useRef();var chartClickHandler=function chartClickHandler(event){var elmt=getElementAtEvent(chartRef.current,event);if(elmt[0]){var dataset_idx=elmt[0].datasetIndex;var data_idx=elmt[0].index;console.log(arr_posts[dataset_idx][data_idx]);setPosts(arr_posts[dataset_idx][data_idx]);}};var toggleKeyword=function toggleKeyword(){if(keywdBtn.disabledInput){return/*#__PURE__*/_jsx(CSpinner,{component:\"span\",size:\"sm\",\"aria-hidden\":\"true\"});}else{return/*#__PURE__*/_jsx(_Fragment,{});}};var keywordInputOnchangeHandler=function keywordInputOnchangeHandler(event){search_keyword=event.target.value;console.log(\"Input changed: \".concat(search_keyword));};var keywordBtnClickhandler=function keywordBtnClickhandler(event){if(search_keyword!==\"\"){setKeywdBtn({disabledInput:true,disabledBtn:true,text:'Loading..'});console.log(search_keyword);axios.get(\"\".concat(url,\"keyword-search/get\"),{params:{start_date:start_date,end_date:end_date,keyword:search_keyword}}).then(function(response){console.log('get response');var flow=response.data.datasets;getFlow(flow);var x_label=response.data.labels;getX(x_label);arr_posts=response.data.posts;setKeywdBtn({disabledInput:false,disabledBtn:false,text:'submit'});}).catch(function(error){return console.error(\"keyword Search Error: \".concat(error));});}console.log('keywordBtn Clicked!');};var categoryClickHandler=function categoryClickHandler(event){var btnId=event.target.getAttribute('id');// btnColors[btnId] = !btnColors[btnId]\nbtnColors=[false,false,false,false,false,false,false,false,false,false,false];btnColors[btnId]=true;setColor(btnColors);setPosts([]);var selected_categories=[];for(var i=0;i<btnColors.length;i++){if(btnColors[i])selected_categories.push(i+1);}axios.get(\"\".concat(url,\"categorical-chart/get\"),{params:{start_date:start_date,end_date:end_date,selected_categories:selected_categories}}).then(function(response){var flow=response.data.datasets;getFlow(flow);var x_label=response.data.labels;getX(x_label);arr_posts=response.data.posts;}).catch(function(error){return console.error(\"Error: \".concat(error));});};return/*#__PURE__*/_jsxs(CCard,{className:\"mb-4\",children:[/*#__PURE__*/_jsxs(CButton,{color:\"warning\",onClick:function onClick(){return window.open('http://ark10806.iptime.org:6006');},className:\"d-grid gap-2\",children:[/*#__PURE__*/_jsx(CIcon,{icon:cilMagnifyingGlass}),\"3D Plot : Visualize Clusters\"]}),/*#__PURE__*/_jsxs(CCardFooter,{children:[/*#__PURE__*/_jsx(CRow,{xs:{cols:2},md:{cols:5},className:\"text-center\",children:categoryPanel.map(function(item,index){return/*#__PURE__*/_jsx(CCol,{className:\"mb-sm-2 mb-0\",children:/*#__PURE__*/_jsx(CButton,{id:index,onClick:categoryClickHandler,className:\"text-medium-emphasis\",shape:\"rounded-pill\",color:btnColor[index]===true?'success':'#9da5b1',style:{width:'120px'},children:item.title})},index);})}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(\"div\",{children:\"\\uD0A4\\uC6CC\\uB4DC\\uB294 \\uC9E7\\uC740 \\uB2E8\\uC5B4 \\\"Trump\\\" \\uB300\\uC2E0 \\\"Donald Trump the president of United States\\\" \\uAC19\\uC774 \\uBB38\\uC7A5\\uC73C\\uB85C \\uC81C\\uACF5\\uD560 \\uB54C \\uC88B\\uC740 \\uAC80\\uC0C9 \\uC131\\uB2A5\\uC744 \\uBCF4\\uC785\\uB2C8\\uB2E4.  \"}),/*#__PURE__*/_jsxs(CInputGroup,{children:[/*#__PURE__*/_jsx(CFormInput,{disabled:keywdBtn.disabledInput,onChange:keywordInputOnchangeHandler,placeholder:\"Search twit by your own keyword (ex. vaccination for covid-19.)\",\"aria-label\":\"Recipient's username with two button addons\"}),/*#__PURE__*/_jsxs(CButton,{disabled:keywdBtn.disabledBtn,onClick:keywordBtnClickhandler,type:\"button\",color:\"secondary\",variant:\"outline\",children:[toggleKeyword(),keywdBtn.text]})]})]}),/*#__PURE__*/_jsxs(CCardBody,{children:[/*#__PURE__*/_jsxs(CRow,{children:[/*#__PURE__*/_jsxs(CCol,{sm:5,children:[/*#__PURE__*/_jsx(\"h4\",{id:\"traffic\",className:\"card-title mb-0\",children:\"Trends\"}),/*#__PURE__*/_jsx(\"div\",{className:\"small text-medium-emphasis\",children:\"January - December 2021\"}),/*#__PURE__*/_jsx(\"div\",{className:\"small text-medium-emphasis\",children:\"\\uADF8\\uB798\\uD504\\uC758 \\uAC01 \\uC9C0\\uC810\\uC744 \\uD074\\uB9AD\\uD558\\uC5EC \\uAD00\\uB828 \\uD3EC\\uC2A4\\uD2B8\\uB4E4\\uC744 \\uD655\\uC778\\uD558\\uC2E4 \\uC218 \\uC788\\uC2B5\\uB2C8\\uB2E4.\"}),/*#__PURE__*/_jsx(\"div\",{className:\"small text-medium-emphasis\",children:\"\\uAC01 \\uD074\\uB7EC\\uC2A4\\uD130\\uC758 \\uBC94\\uB840(legend)\\uB97C \\uD074\\uB9AD\\uD558\\uC5EC \\uC77C\\uBD80 \\uD074\\uB7EC\\uC2A4\\uD130\\uB97C \\uBCF4\\uC774\\uC9C0 \\uC54A\\uAC8C \\uD560 \\uC218 \\uC788\\uC2B5\\uB2C8\\uB2E4\"}),/*#__PURE__*/_jsx(\"div\",{className:\"small text-medium-emphasis\",children:\"\\uAC01 \\uD074\\uB7EC\\uC2A4\\uD130\\uB294 \\uC704\\uC758 3D Plotly \\uBC84\\uD2BC\\uC744 \\uD1B5\\uD574 \\uC2DC\\uAC01\\uC801\\uC73C\\uB85C \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uC2B5\\uB2C8\\uB2E4.\"})]}),/*#__PURE__*/_jsx(CCol,{sm:7,className:\"d-none d-md-block\"})]}),/*#__PURE__*/_jsx(Line,{onClick:chartClickHandler,ref:chartRef,id:\"myChart\",data:{labels:x,datasets:flows.map(function(value){return{label:value.label,data:value.data,fill:true,backgroundColor:\"rgba(75,192,192,0.2)\",borderColor:\"rgba(75,192,192,1)\"};})},options:{responsive:true}}),/*#__PURE__*/_jsx(\"br\",{}),posts.map(function(item,index){return/*#__PURE__*/_jsxs(CRow,{children:[/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(CCol,{children:/*#__PURE__*/_jsx(CImage,{rounded:true,thumbnail:true,src:item.image,width:\"500vw\"})},\"0\"),/*#__PURE__*/_jsxs(CCol,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"border-start border-start-4 border-start-danger py-1 px-3 mb-3\",children:/*#__PURE__*/_jsx(\"div\",{children:item.text})}),/*#__PURE__*/_jsxs(\"div\",{className:\"progress-group mb-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"progress-group-header\",children:[/*#__PURE__*/_jsx(CIcon,{className:\"me-2\",icon:cilUser,size:\"lg\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Cluster Similarity\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"ms-auto fw-semibold\",children:[parseInt(item.similarity*100),\"%\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"progress-group-bars\",children:/*#__PURE__*/_jsx(CProgress,{thin:true,color:\"success\",value:parseInt(item.similarity*100)})})]}),/*#__PURE__*/_jsxs(CButton,{color:\"#00aced\",onClick:function onClick(){return window.open(item.posturl);},className:\"float-end\",children:[/*#__PURE__*/_jsx(CIcon,{icon:cibTwitter}),\"see post\"]})]},\"1\"),/*#__PURE__*/_jsx(\"br\",{})]},index);})]})]});};","map":{"version":3,"sources":["/home/seungchan/Desktop/Projs/kakao/Kakao_ML/frontend/src/views/dashboard/DataInterface.js"],"names":["React","useState","useRef","axios","proxyAddr","CButton","CButtonGroup","CCard","CCardBody","CCardFooter","CProgress","CCol","CRow","CImage","CSpinner","CFormInput","CInputGroup","defaults","withCredentials","CIcon","cibTwitter","cilCloudDownload","cilUser","cilMagnifyingGlass","Line","getElementAtEvent","Chart","registerables","register","btnColors","categoryPanel","title","arr_posts","search_keyword","DrawChart","disabledInput","disabledBtn","text","keywdBtn","setKeywdBtn","posts","setPosts","flows","getFlow","x","getX","btnColor","setColor","url","start_date","Date","end_date","chartRef","chartClickHandler","event","elmt","current","dataset_idx","datasetIndex","data_idx","index","console","log","toggleKeyword","keywordInputOnchangeHandler","target","value","keywordBtnClickhandler","get","params","keyword","then","response","flow","data","datasets","x_label","labels","catch","error","categoryClickHandler","btnId","getAttribute","selected_categories","i","length","push","window","open","cols","map","item","width","label","fill","backgroundColor","borderColor","responsive","image","parseInt","similarity","posturl"],"mappings":"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","sourcesContent":["import React, { useState, useRef } from 'react'\nimport axios from 'axios'\nimport {proxyAddr}  from './ProxyAddr'\n// import { proxyAddr } from './ProxyAddr'\n\nimport {\n  CButton,\n  CButtonGroup,\n  CCard,\n  CCardBody,\n  CCardFooter,\n  CProgress,\n  CCol,\n  CRow,\n  CImage,\n  CSpinner,\n  CFormInput,\n  CInputGroup,\n} from '@coreui/react'\naxios.defaults.withCredentials = true;\n\n\nimport CIcon from '@coreui/icons-react'\nimport {\n  cibTwitter,\n  cilCloudDownload,\n  cilUser,\n  cilMagnifyingGlass,\n} from '@coreui/icons'\n\nimport { Line, getElementAtEvent } from \"react-chartjs-2\";\nimport { Chart, registerables } from 'chart.js';\nChart.register(...registerables);\n\nvar btnColors = [\n  false, false, false, false, false, false, false, false, false, false, false\n]\n\n\n//! daily, weekly, montly, year로 다양화 필요\nconst categoryPanel = [\n  {title: 'politics'},\n  {title: 'social'},\n  {title: 'economy'},\n  {title: 'fashion'},\n  {title: 'entertain'},\n  {title: 'sports'},\n  {title: 'foods'},\n  {title: 'animals'},\n  {title: 'selfies'},\n  {title: 'memes'},\n  {title: 'cartoons'},\n  {title: 'movies'},\n  {title: 'games'},\n  {title: 'landscapes'},\n]\n\n\nvar arr_posts;\nvar search_keyword = \"\";\n\nexport const DrawChart = () => {\n  const [keywdBtn, setKeywdBtn] = useState({disabledInput: false, disabledBtn: false, text: 'submit'})\n  const [posts, setPosts] = useState([])\n  const [flows, getFlow] = useState([])\n  const [x, getX] = useState([])\n  const [btnColor, setColor] = useState(btnColors)\n  const url = proxyAddr()\n  const start_date = new Date('2021-01-01')\n  const end_date = new Date('2022-02-01')\n  const chartRef = useRef();\n\n  const chartClickHandler = (event) => {\n    var elmt = getElementAtEvent(chartRef.current, event);\n    if (elmt[0]){\n      const dataset_idx = elmt[0].datasetIndex\n      const data_idx = elmt[0].index\n      console.log(arr_posts[dataset_idx][data_idx])\n      setPosts(arr_posts[dataset_idx][data_idx])\n    }\n  }\n\n  const toggleKeyword = () => {\n    if (keywdBtn.disabledInput){\n      return (\n        <CSpinner component=\"span\" size=\"sm\" aria-hidden=\"true\"/>\n      )\n    }\n    else{\n      return (\n        <></>\n      )\n    }\n  }\n\n  const keywordInputOnchangeHandler = (event) => {\n    search_keyword = event.target.value;\n    console.log(`Input changed: ${search_keyword}`)\n  }\n\n  const keywordBtnClickhandler = (event) => {\n    if (search_keyword !== \"\"){\n      setKeywdBtn({disabledInput: true, disabledBtn: true, text: 'Loading..'})\n      console.log(search_keyword);\n      axios\n      .get(`${url}keyword-search/get`, {\n        params: {\n          start_date: start_date,\n          end_date: end_date,\n          keyword: search_keyword\n        },\n      })\n      .then((response) => {\n        console.log('get response')\n        const flow = response.data.datasets\n        getFlow(flow)\n\n        const x_label = response.data.labels\n        getX(x_label)\n\n        arr_posts = response.data.posts;\n        setKeywdBtn({disabledInput: false, disabledBtn: false, text: 'submit'})\n    })\n      .catch((error) => console.error(`keyword Search Error: ${error}`))\n    }\n    console.log('keywordBtn Clicked!')\n\n  }\n\n\n\n  const categoryClickHandler = (event) => {\n    const btnId = event.target.getAttribute('id')\n    // btnColors[btnId] = !btnColors[btnId]\n    btnColors = [ false, false, false, false, false, false, false, false, false, false, false ]\n    btnColors[btnId] = true\n    setColor(btnColors)\n    setPosts([])\n    const selected_categories = [];\n    for (var i=0; i<btnColors.length; i++){\n      if (btnColors[i])\n        selected_categories.push(i+1);\n    }\n\n    axios\n      .get(`${url}categorical-chart/get`, {\n        params: {\n          start_date: start_date,\n          end_date: end_date,\n          selected_categories: selected_categories,\n        },\n      })\n      .then((response) => {\n        const flow = response.data.datasets\n        getFlow(flow)\n\n        const x_label = response.data.labels\n        getX(x_label)\n\n        arr_posts = response.data.posts;\n      })\n      .catch((error) => console.error(`Error: ${error}`))\n  }\n\n\n\n  return (\n      <CCard className=\"mb-4\">\n      {/* <CButton color=\"warning\" onClick={() => window.open('http://localhost:6006')} className=\"d-grid gap-2\"> */}\n      <CButton color=\"warning\" onClick={() => window.open('http://ark10806.iptime.org:6006')} className=\"d-grid gap-2\">\n        <CIcon icon={cilMagnifyingGlass} />3D Plot : Visualize Clusters\n      </CButton>\n        <CCardFooter>\n          <CRow xs={{ cols: 2 }} md={{ cols: 5 }} className=\"text-center\">\n            {categoryPanel.map((item, index) => (\n                <CCol className=\"mb-sm-2 mb-0\" key={index}>\n                <CButton id={index} onClick={categoryClickHandler} className=\"text-medium-emphasis\" shape='rounded-pill' color={btnColor[index]===true ? 'success' : '#9da5b1'} style={{ width: '120px' }}>{item.title}</CButton>\n                </CCol>\n            ))}\n            </CRow>\n            <hr/>\n          {/* <CRow xs={{ cols: 2 }} md={{ cols: 2 }} className=\"text-center\"> */}\n          <div>키워드는 짧은 단어 \"Trump\" 대신 \"Donald Trump the president of United States\" 같이 문장으로 제공할 때 좋은 검색 성능을 보입니다.  </div>\n\n            <CInputGroup>\n              <CFormInput disabled={keywdBtn.disabledInput} onChange={keywordInputOnchangeHandler} placeholder=\"Search twit by your own keyword (ex. vaccination for covid-19.)\" aria-label=\"Recipient's username with two button addons\"/>\n              <CButton disabled={keywdBtn.disabledBtn} onClick={keywordBtnClickhandler} type=\"button\" color=\"secondary\" variant=\"outline\">{toggleKeyword()}{keywdBtn.text}</CButton>\n            </CInputGroup>\n          {/* </CRow> */}\n\n        </CCardFooter>\n        <CCardBody>\n          <CRow>\n            <CCol sm={5}>\n              <h4 id=\"traffic\" className=\"card-title mb-0\">\n                Trends\n              </h4>\n              <div className=\"small text-medium-emphasis\">January - December 2021</div>\n              <div className=\"small text-medium-emphasis\">그래프의 각 지점을 클릭하여 관련 포스트들을 확인하실 수 있습니다.</div>\n              <div className=\"small text-medium-emphasis\">각 클러스터의 범례(legend)를 클릭하여 일부 클러스터를 보이지 않게 할 수 있습니다</div>\n              <div className=\"small text-medium-emphasis\">각 클러스터는 위의 3D Plotly 버튼을 통해 시각적으로 확인할 수 있습니다.</div>\n            </CCol>\n            <CCol sm={7} className=\"d-none d-md-block\">\n              {/* <CButton color=\"primary\" className=\"float-end\">\n                <CIcon icon={cilCloudDownload} />\n              </CButton>\n              <CButtonGroup className=\"float-end me-3\">\n                {['Day', 'Month', 'Year'].map((value) => (\n                  <CButton\n                    color=\"outline-secondary\"\n                    key={value}\n                    className=\"mx-0\"\n                    active={value === 'Month'}\n                  >\n                    {value}\n                  </CButton>\n                ))}\n              </CButtonGroup> */}\n            </CCol>\n          </CRow>\n\n          <Line\n            onClick={chartClickHandler}\n            ref={chartRef}\n            id=\"myChart\"\n            data={{\n              labels: x,\n              datasets: flows.map((value) => ({\n                label: value.label,\n                data: value.data,\n                fill: true,\n                backgroundColor: \"rgba(75,192,192,0.2)\",\n                borderColor: \"rgba(75,192,192,1)\"\n              })),\n          }}\n          options= {{\n            responsive: true,\n          }}\n          ></Line>\n          <br/>\n          {posts.map((item, index) => (\n            <CRow key={index}>\n              <br/>\n              <hr/>\n              <br/>\n              <CCol key=\"0\">\n                  <CImage rounded thumbnail src={item.image} width='500vw' />\n                  {/* <CImage rounded thumbnail src={item.image} width='256px' height='512hv' /> */}\n              </CCol>\n              <CCol key=\"1\">\n                <div className=\"border-start border-start-4 border-start-danger py-1 px-3 mb-3\">\n                  <div>{item.text}</div>\n                </div>\n                <div className=\"progress-group mb-4\">\n                  <div className=\"progress-group-header\">\n                    <CIcon className=\"me-2\" icon={cilUser} size=\"lg\" />\n                    <span>Cluster Similarity</span>\n                    <span className=\"ms-auto fw-semibold\">{parseInt(item.similarity*100)}%</span>\n                  </div>\n                  <div className=\"progress-group-bars\">\n                    <CProgress thin color=\"success\" value={parseInt(item.similarity*100)} />\n                  </div>\n                </div>\n                <CButton color=\"#00aced\" onClick={() => window.open(item.posturl)} className=\"float-end\">\n                  <CIcon icon={cibTwitter} />see post\n                </CButton>\n              </CCol>\n              <br/>\n            </CRow>\n          ))}\n\n        </CCardBody>\n      </CCard>\n  )\n}\n"]},"metadata":{},"sourceType":"module"}